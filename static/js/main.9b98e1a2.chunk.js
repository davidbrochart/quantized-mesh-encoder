(this.webpackJsonpsite=this.webpackJsonpsite||[]).push([[0],{192:function(e,t){},298:function(e,t,a){e.exports=a(429)},303:function(e,t,a){},304:function(e,t){},428:function(e,t,a){},429:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),o=a(96),i=a.n(o),l=(a(303),a(197)),c=a(251),m=a(252),u=a(279),s=a(276),h=a(452),d=a(189),g=a.n(d),p=a(277),f=a(253),b=a(199),v=a(453),y=a(460),E=a(21),w=a(454),x=a(456),k=a(459),z=a(20),A=[1],S="pk.eyJ1Ijoia3lsZWJhcnJvbiIsImEiOiJja2c0bDg4ZGEwbHI4MnNvMzd2bHM2ZDJ5In0.1KD5cEoyiyW3fb3MXQkAvA";function M(e){return(77067.34/(1<<e)).toFixed(2)}function O(e){var t=e.x,a=e.y,n=e.z,r=e.mosaicUrl,o=void 0===r?"terrarium":r,i=e.meshAlgorithm,l=void 0===i?"pydelatin":i,c=e.meshMaxError,m=new URLSearchParams({url:o,mesh_max_error:void 0===c?10:c,mesh_algorithm:l,flip_y:"pydelatin"===l});return"https://us-east-1-lambda.kylebarron.dev/dem/mesh/".concat(n,"/").concat(t,"/").concat(a,".terrain?")+m.toString()}function j(e){var t=e||{},a=t.minZoom,n=void 0===a?0:a,r=t.maxZoom,o=void 0===r?15:r,i=t.onViewportLoad,l=t.zRange,c=t.meshAlgorithm,m=t.loadTexture;return new v.a({id:"quantized-mesh-tile",minZoom:n,maxZoom:o,getTileData:function(e){return function(e){return T.apply(this,arguments)}(Object(b.a)(Object(b.a)({},e),{},{meshAlgorithm:c,loadTexture:m}))},renderSubLayers:_,onViewportLoad:i,zRange:l,refinementStrategy:"no-overlap",tileSize:256,updateTriggers:{getTileData:[c,m]}})}function T(){return(T=Object(f.a)(g.a.mark((function e(t){var a,n,r,o,i,l,c,m,u,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.x,n=t.y,r=t.z,o=t.meshAlgorithm,i=t.loadTexture,l=M(r),c=O({x:a,y:n,z:r,meshMaxError:l,meshAlgorithm:o}),m=Object(w.a)(c,k.a),u="https://api.mapbox.com/v4/mapbox.satellite/".concat(r,"/").concat(a,"/").concat(n,".png?access_token=").concat(S),i&&(s=Object(w.a)(u,x.a)),e.abrupt("return",Promise.all([m,s]));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){var t=e.data,a=e.tile,n=t||[],r=Object(p.a)(n,2),o=r[0],i=r[1];return[new y.a(e,{data:A,mesh:o,texture:i,getPolygonOffset:null,coordinateSystem:E.a.CARTESIAN,modelMatrix:I(a),getPosition:function(e){return[0,0,0]},getColor:[200,200,200]})]}function I(e){var t=Math.pow(2,e.z),a=512/t,n=-a,r=512*e.x/t,o=512*(1-e.y/t);return(new z.a).translate([r,o,0]).scale([a,n,1])}var C=a(200),R=a(450),D=a(455),J=a(451),L=a(458),P=[{key:"pydelatin",value:"pydelatin",text:"Algorithm: Delatin"},{key:"pymartini",value:"pymartini",text:"Algorithm: Martini"}];function Z(e){var t=e.meshAlgorithm,a=e.loadTexture,n=e.onChange,o=[{key:"main-panel",title:"Serverless 3D Terrain",content:{content:r.a.createElement("div",null,r.a.createElement("p",null,"Uses"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/kylebarron/pydelatin"},r.a.createElement(C.a,{name:"github"}),r.a.createElement("code",null,"pydelatin"))," ","or"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/kylebarron/pymartini"},r.a.createElement(C.a,{name:"github"}),r.a.createElement("code",null,"pymartini"))," ","for mesh generation,"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/kylebarron/quantized-mesh-encoder"},r.a.createElement(C.a,{name:"github"}),r.a.createElement("code",null,"quantized-mesh-encoder"))," ","for encoding to"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/CesiumGS/quantized-mesh"},"quantized mesh"),","," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/kylebarron/dem-tiler"},r.a.createElement(C.a,{name:"github"}),r.a.createElement("code",null,"dem-tiler"))," ","for the serverless API, and"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://deck.gl"},r.a.createElement("code",null,"deck.gl"))," ","for rendering."," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/kylebarron/quantized-mesh-encoder/tree/master/site"},r.a.createElement(C.a,{name:"github"}),"Example source.")),r.a.createElement("p",null,"If you look closely, you should be able to see small differences between the Delatin and Martini meshes. Namely all of Martini's triangles are ",r.a.createElement("i",null,"right")," triangles, while Delatin doesn't have that restriction, allowing it to have a more efficient mesh (fewer triangles) for a given maximum error."),r.a.createElement(R.a,{label:"Overlay satellite imagery",checked:a,onClick:function(e,t){var a=t.checked;return n({loadTexture:a})}}),r.a.createElement("br",null),r.a.createElement(D.a,{placeholder:"Select mesh algorithm",options:P,value:t,onChange:function(e,t){var a=t.value;return n({meshAlgorithm:a})}}))}}];return r.a.createElement(J.a,{style:{position:"absolute",width:400,left:5,top:5,padding:5,maxHeight:"50%",zIndex:1,pointerEvents:"auto",overflowY:"auto",overflow:"visible"}},r.a.createElement(L.a,{defaultActiveIndex:0,styled:!0,panels:o,style:{maxWidth:"90%"}}))}a(428);var q={latitude:48.7,longitude:-113.81,bearing:-3.3,pitch:65,zoom:11.6,maxPitch:89},V=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={viewState:q,zRange:null,meshAlgorithm:"pydelatin",loadTexture:!0},e.onViewportLoad=function(t){if(t&&0!==t.length&&!t.every((function(e){return!e}))){var a=e.state.zRange,n=t.filter(Boolean).map((function(e){return e[0].header.boundingBox.map((function(e){return e[2]}))})),r=Math.min.apply(Math,Object(l.a)(n.map((function(e){return e[0]})))),o=Math.max.apply(Math,Object(l.a)(n.map((function(e){return e[1]}))));(!a||r<a[0]||o>a[1])&&e.setState({zRange:[r,o]})}},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.viewState,n=t.zRange,o=t.meshAlgorithm,i=t.loadTexture,l=[j({onViewportLoad:this.onViewportLoad,zRange:n,meshAlgorithm:o,loadTexture:i})];return r.a.createElement("div",null,r.a.createElement(h.a,{style:{backgroundColor:"rgb(0, 0, 0)"},viewState:a,layers:l,onViewStateChange:function(t){var a=t.viewState;return e.setState({viewState:a})},controller:{touchRotate:!0},glOptions:{powerPreference:"high-performance"}},r.a.createElement(Z,{meshAlgorithm:o,loadTexture:i,onChange:function(t){return e.setState(t)}})))}}]),a}(r.a.Component);document.body.style.margin=0;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[298,1,2]]]);
//# sourceMappingURL=main.9b98e1a2.chunk.js.map